

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Client &amp; Connections &mdash; Riak Python Client 2.7.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Riak Python Client 2.7.0 documentation" href="index.html"/>
        <link rel="next" title="Buckets &amp; Bucket Types" href="bucket.html"/>
        <link rel="prev" title="Riak Python Client" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Riak Python Client
          

          
          </a>

          
            
            
              <div class="version">
                2.7.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Client &amp; Connections</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#client-objects">Client objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nodes">Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#retry-logic">Retry logic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#client-level-operations">Client-level Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-bucket-types-and-buckets">Accessing Bucket Types and Buckets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bucket-type-operations">Bucket Type Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bucket-operations">Bucket Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-level-operations">Key-level Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timeseries-operations">Timeseries Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-operations">Query Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#search-maintenance-operations">Search Maintenance Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#serialization">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deprecated-features">Deprecated Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#full-text-search">Full-text search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legacy-counters">Legacy Counters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bucket.html">Buckets &amp; Bucket Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Values &amp; Objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="datatypes.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="query.html">Query Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Usage &amp; Internals</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Riak Python Client</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Client &amp; Connections</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/client.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="client-connections">
<h1>Client &amp; Connections<a class="headerlink" href="#client-connections" title="Permalink to this headline">¶</a></h1>
<p>To connect to a Riak cluster, you must create a
<code class="xref py py-class docutils literal"><span class="pre">RiakClient</span></code> object. The default configuration
connects to a single Riak node on <code class="docutils literal"><span class="pre">localhost</span></code> with the default
ports. The below instantiation statements are all equivalent:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">riak</span> <span class="k">import</span> <span class="n">RiakClient</span><span class="p">,</span> <span class="n">RiakNode</span>

<span class="n">RiakClient</span><span class="p">()</span>
<span class="n">RiakClient</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">http_port</span><span class="o">=</span><span class="mi">8098</span><span class="p">)</span>
<span class="n">RiakClient</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;host&#39;</span><span class="p">:</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span><span class="s1">&#39;http_port&#39;</span><span class="p">:</span><span class="mi">8098</span><span class="p">}])</span>
<span class="n">RiakClient</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="n">RiakNode</span><span class="p">()])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Connections are not established until you attempt to perform
an operation. If the host or port are incorrect, you will not get
an error raised immediately.</p>
</div>
<p>The client maintains a connection pool behind the scenes, one for each
protocol. Connections are opened as-needed; a random node is selected
when a new connection is requested.</p>
<div class="section" id="client-objects">
<h2>Client objects<a class="headerlink" href="#client-objects" title="Permalink to this headline">¶</a></h2>
<div class="section" id="nodes">
<h3>Nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h3>
<p>The <code class="xref py py-attr docutils literal"><span class="pre">nodes</span></code> attribute of <code class="docutils literal"><span class="pre">RiakClient</span></code> objects is
a list of <code class="docutils literal"><span class="pre">RiakNode</span></code> objects. If you include multiple host
specifications in the <code class="docutils literal"><span class="pre">RiakClient</span></code> constructor, they will be turned
into this type.</p>
</div>
<div class="section" id="retry-logic">
<h3>Retry logic<a class="headerlink" href="#retry-logic" title="Permalink to this headline">¶</a></h3>
<p>Some operations that fail because of network errors or Riak node
failure may be safely retried on another node, and the client will do
so automatically. The items below can be used to configure this
behavior.</p>
</div>
</div>
<div class="section" id="client-level-operations">
<h2>Client-level Operations<a class="headerlink" href="#client-level-operations" title="Permalink to this headline">¶</a></h2>
<p>Some operations are not scoped by buckets or bucket types and can be
performed on the client directly:</p>
</div>
<div class="section" id="accessing-bucket-types-and-buckets">
<h2>Accessing Bucket Types and Buckets<a class="headerlink" href="#accessing-bucket-types-and-buckets" title="Permalink to this headline">¶</a></h2>
<p>Most client operations are on <code class="xref py py-class docutils literal"><span class="pre">bucket</span> <span class="pre">type</span> <span class="pre">objects</span></code>, the <code class="xref py py-class docutils literal"><span class="pre">bucket</span> <span class="pre">objects</span></code> they contain or keys within those buckets. Use the
<code class="docutils literal"><span class="pre">bucket_type</span></code> or <code class="docutils literal"><span class="pre">bucket</span></code> methods for creating bucket types and buckets
that will proxy operations to the called client.</p>
</div>
<div class="section" id="bucket-type-operations">
<h2>Bucket Type Operations<a class="headerlink" href="#bucket-type-operations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="bucket-operations">
<h2>Bucket Operations<a class="headerlink" href="#bucket-operations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="key-level-operations">
<h2>Key-level Operations<a class="headerlink" href="#key-level-operations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="timeseries-operations">
<h2>Timeseries Operations<a class="headerlink" href="#timeseries-operations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="query-operations">
<h2>Query Operations<a class="headerlink" href="#query-operations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="search-maintenance-operations">
<h2>Search Maintenance Operations<a class="headerlink" href="#search-maintenance-operations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="serialization">
<h2>Serialization<a class="headerlink" href="#serialization" title="Permalink to this headline">¶</a></h2>
<p>The client supports automatic transformation of Riak responses into
Python types if encoders and decoders are registered for the
media-types. Supported by default are <code class="docutils literal"><span class="pre">application/json</span></code> and
<code class="docutils literal"><span class="pre">text/plain</span></code>.</p>
</div>
<div class="section" id="deprecated-features">
<h2>Deprecated Features<a class="headerlink" href="#deprecated-features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="full-text-search">
<h3>Full-text search<a class="headerlink" href="#full-text-search" title="Permalink to this headline">¶</a></h3>
<p>The original version of Riak Search has been replaced by <a class="reference internal" href="query.html#yz-label"><span class="std std-ref">Riak Search 2.0 (Yokozuna)</span></a>,
which is full-blown Solr integration with Riak.</p>
<p>If Riak Search 1.0 is enabled, you can query an index via the bucket&#8217;s
<code class="xref py py-meth docutils literal"><span class="pre">search()</span></code> method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bucket</span><span class="o">.</span><span class="n">enable_search</span><span class="p">()</span>
<span class="n">bucket</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;one&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="s1">&#39;one&#39;</span><span class="p">},</span>
           <span class="n">content_type</span><span class="o">=</span><span class="s2">&quot;application/json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">store</span><span class="p">()</span>

<span class="n">bucket</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;value=one&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To manually add and remove documents from an index (without an
associated key), use the <code class="xref py py-class docutils literal"><span class="pre">RiakClient</span></code>
<code class="xref py py-meth docutils literal"><span class="pre">fulltext_add()</span></code> and
<code class="xref py py-meth docutils literal"><span class="pre">fulltext_delete()</span></code> methods directly.</p>
</div>
<div class="section" id="legacy-counters">
<span id="id1"></span><h3>Legacy Counters<a class="headerlink" href="#legacy-counters" title="Permalink to this headline">¶</a></h3>
<p>The first Data Type introduced in Riak 1.4 were <cite>counters</cite>.  These pre-date
<a class="reference internal" href="bucket.html#bucket-types"><span class="std std-ref">Bucket Types</span></a> and the current implementation.
Rather than returning objects, the counter operations
act directly on the value of the counter.  Legacy counters are deprecated
as of Riak 2.0.  Please use <code class="xref py py-class docutils literal"><span class="pre">Counter</span></code> instead.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Legacy counters are incompatible with Bucket Types.</p>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="bucket.html" class="btn btn-neutral float-right" title="Buckets &amp; Bucket Types" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Riak Python Client" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2014, Basho Technologies.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.7.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>